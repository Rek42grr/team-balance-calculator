<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>팀 티어 균형 계산기</title>
    <style>
        body { font-family: Arial, sans-serif; }
        .player-input { margin-bottom: 10px; }
        #result { margin-top: 20px; white-space: pre-line; }
    </style>
</head>
<body>
    <h2>팀 티어 균형 계산기</h2>
    <div id="inputs">
        <!-- 10명의 플레이어 이름과 티어 입력 -->
        <h3>플레이어 입력</h3>
        <div class="player-input">
            <label>플레이어 1: 이름 <input type="text" id="player_name1"> 티어 
                <select class="tier-select" id="player_tier1"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 2: 이름 <input type="text" id="player_name2"> 티어 
                <select class="tier-select" id="player_tier2"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 3: 이름 <input type="text" id="player_name3"> 티어 
                <select class="tier-select" id="player_tier3"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 4: 이름 <input type="text" id="player_name4"> 티어 
                <select class="tier-select" id="player_tier4"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 5: 이름 <input type="text" id="player_name5"> 티어 
                <select class="tier-select" id="player_tier5"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 6: 이름 <input type="text" id="player_name6"> 티어 
                <select class="tier-select" id="player_tier6"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 7: 이름 <input type="text" id="player_name7"> 티어 
                <select class="tier-select" id="player_tier7"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 8: 이름 <input type="text" id="player_name8"> 티어 
                <select class="tier-select" id="player_tier8"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 9: 이름 <input type="text" id="player_name9"> 티어 
                <select class="tier-select" id="player_tier9"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 10: 이름 <input type="text" id="player_name10"> 티어 
                <select class="tier-select" id="player_tier10"></select>
            </label>
        </div>
    </div>
    <button onclick="calculateBalancedTeams()">팀 나누기</button>
    <div id="result"></div>

    <script>
        const tierDistribution = {
            "챌린저": 0.0064,
            "그랜드마스터": 0.0310,
            "마스터": 0.1600,
            "다이아몬드 I": 0.1600,
            "다이아몬드 II": 0.3600,
            "다이아몬드 III": 0.6500,
            "다이아몬드 IV": 1.4000,
            "에메랄드 I": 0.8700,
            "에메랄드 II": 1.4000,
            "에메랄드 III": 2.0000,
            "에메랄드 IV": 3.4000,
            "플레티넘 I": 1.4000,
            "플레티넘 II": 2.2000,
            "플레티넘 III": 3.0000,
            "플레티넘 IV": 4.9000,
            "골드 I": 2.7000,
            "골드 II": 4.0000,
            "골드 III": 4.6000,
            "골드 IV": 6.9000,
            "실버 I": 3.6000,
            "실버 II": 5.2000,
            "실버 III": 5.8000,
            "실버 IV": 7.7000,
            "브론즈 I": 4.1000,
            "브론즈 II": 5.5000,
            "브론즈 III": 5.4000,
            "브론즈 IV": 6.3000,
            "아이언 I": 3.0000,
            "아이언 II": 3.8000,
            "아이언 III": 4.3000,
            "아이언 IV": 4.0000
        };

        // 티어 옵션을 모든 select 요소에 추가하는 함수
        function populateTierOptions() {
            const tierSelectElements = document.querySelectorAll('.tier-select');
            const tierOptions = Object.keys(tierDistribution).map(tier => `<option value="${tier}">${tier}</option>`).join('');
            tierSelectElements.forEach(select => {
                select.innerHTML = `<option value="">티어 선택</option>${tierOptions}`;
            });
        }

        function calculateBalancedTeams() {
            let players = [];

            for (let i = 1; i <= 10; i++) {
                let name = document.getElementById('player_name' + i).value;
                let tierName = document.getElementById('player_tier' + i).value;
                if (name.trim() !== "" && tierName.trim() !== "") {
                    let tier = tierDistribution[tierName];
                    players.push({ name: name, tier: tier, tierName: tierName });
                }
            }

            if (players.length !== 10) {
                document.getElementById('result').innerText = '모든 플레이어의 정보를 올바르게 입력해 주세요.';
                return;
            }

            // 가능한 모든 팀 조합을 생성하여 가장 균형 잡힌 팀을 선택
            let bestTeam1 = [];
            let bestTeam2 = [];
            let minDiff = Infinity;

            function combinations(arr, k) {
                let result = [];
                function combRecursive(start, chosen) {
                    if (chosen.length === k) {
                        result.push(chosen.slice());
                        return;
                    }
                    for (let i = start; i < arr.length; i++) {
                        chosen.push(arr[i]);
                        combRecursive(i + 1, chosen);
                        chosen.pop();
                    }
                }
                combRecursive(0, []);
                return result;
            }

            let teamCombinations = combinations(players, 5);
            for (let team1 of teamCombinations) {
                let team2 = players.filter(player => !team1.includes(player));

                // 팀의 티어 평균 계산 (분포도를 고려한 가중치 적용)
                let avgTier1 = team1.reduce((sum, player) => sum + player.tier, 0) / 5;
                let avgTier2 = team2.reduce((sum, player) => sum + player.tier, 0) / 5;
                let diff = Math.abs(avgTier1 - avgTier2);

                if (diff < minDiff) {
                    minDiff = diff;
                    bestTeam1 = [...team1];
                    bestTeam2 = [...team2];
                }
            }

            // 평균 티어 계산 (수치 대신 실제 티어 표기)
            function getAverageTier(tierValue) {
                let closestTier = Object.entries(tierDistribution).reduce((prev, curr) => 
                    Math.abs(curr[1] - tierValue) < Math.abs(prev[1] - tierValue) ? curr : prev
                );
                return closestTier[0];
            }

            let avgTier1Name = getAverageTier(bestTeam1.reduce((sum, player) => sum + player.tier, 0) / 5);
            let avgTier2Name = getAverageTier(bestTeam2.reduce((sum, player) => sum + player.tier, 0) / 5);

            // 내부 데이터를 정렬하고 정렬된 데이터를 출력합니다.
            let sortedTeam1 = [...bestTeam1].sort((a, b) => a.tier - b.tier);
            let sortedTeam2 = [...bestTeam2].sort((a, b) => a.tier - b.tier);

            // 결과 출력
            let resultText = `팀 1: ${sortedTeam1.map(p => p.name).join(', ')} (평균 티어: ${avgTier1Name}) ${sortedTeam1.map(p => p.tierName).join(', ')}\n`;
            resultText += `팀 2: ${sortedTeam2.map(p => p.name).join(', ')} (평균 티어: ${avgTier2Name}) ${sortedTeam2.map(p => p.tierName).join(', ')}\n`;
            resultText += `팀 티어 평균 차이: ${minDiff.toFixed(4)} (${getAverageTier(minDiff)} 티어 ${minDiff.toFixed(2)}인분의 차이)`;

            document.getElementById('result').innerText = resultText;
        }

        // 페이지 로드 시 티어 옵션 채우기
        window.onload = populateTierOptions;
    </script>
</body>
</html>
