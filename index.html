<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>팀 균형 계산기</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            /*background-image: url('t1.jpg');
            background-size: cover;
            background-position: center;*/
        }
        .player-input { margin-bottom: 10px; }
        #inputs { display: inline-block; text-align: left; }
        #result { margin-top: 20px; white-space: pre-line; }
        .team-button {
            margin-top: 20px;  
            display: block;
            margin-left: auto; 
            margin-right: auto; 
        }
        </style>
</head>
<body>
    <h2>팀 균형 계산기</h2>
    <div id="inputs">
        <!-- 10명의 플레이어 이름과 티어 입력 -->
        <div class="player-input">
            <label>플레이어 1: 이름 <input type="text" id="player_name1"> 티어 
                <select class="tier-select" id="player_tier1"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 2: 이름 <input type="text" id="player_name2"> 티어 
                <select class="tier-select" id="player_tier2"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 3: 이름 <input type="text" id="player_name3"> 티어 
                <select class="tier-select" id="player_tier3"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 4: 이름 <input type="text" id="player_name4"> 티어 
                <select class="tier-select" id="player_tier4"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 5: 이름 <input type="text" id="player_name5"> 티어 
                <select class="tier-select" id="player_tier5"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 6: 이름 <input type="text" id="player_name6"> 티어 
                <select class="tier-select" id="player_tier6"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 7: 이름 <input type="text" id="player_name7"> 티어 
                <select class="tier-select" id="player_tier7"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 8: 이름 <input type="text" id="player_name8"> 티어 
                <select class="tier-select" id="player_tier8"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 9: 이름 <input type="text" id="player_name9"> 티어 
                <select class="tier-select" id="player_tier9"></select>
            </label>
        </div>
        <div class="player-input">
            <label>플레이어 10: 이름 <input type="text" id="player_name10"> 티어 
                <select class="tier-select" id="player_tier10"></select>
            </label>
        </div>
    </div>
    <button onclick="calculateBalancedTeams()" class="team-button">팀 나누기</button>
    <div id="result"></div>

    <script>
        const tierDistribution = {
            "챌린저": 10,
            "그랜드마스터": 9,
            "마스터": 8,
            "다이아몬드 I": 7,
            "다이아몬드 II": 6.5,
            "다이아몬드 III": 6,
            "다이아몬드 IV": 5.5,
            "에메랄드 I": 5,
            "에메랄드 II": 4.5,
            "에메랄드 III": 4,
            "에메랄드 IV": 3.5,
            "플레티넘 I": 3,
            "플레티넘 II": 2.5,
            "플레티넘 III": 2,
            "플레티넘 IV": 1.5,
            "골드 I": 1.4,
            "골드 II": 1.3,
            "골드 III": 1.2,
            "골드 IV": 1.1,
            "실버 I": 1,
            "실버 II": 0.9,
            "실버 III": 0.8,
            "실버 IV": 0.7,
            "브론즈 I": 0.6,
            "브론즈 II": 0.5,
            "브론즈 III": 0.4,
            "브론즈 IV": 0.3,
            "아이언 I": 0.2,
            "아이언 II": 0.15,
            "아이언 III": 0.1,
            "아이언 IV": 0.05
        };

        function populateTierOptions() {
            const tierSelectElements = document.querySelectorAll('.tier-select');
            const tierOptions = Object.keys(tierDistribution).map(tier => `<option value="${tier}">${tier}</option>`).join('');
            tierSelectElements.forEach(select => {
                select.innerHTML = `<option value="">티어 선택</option>${tierOptions}`;
            });
        }

        function getAverageTierName(avgTierValue) {
            let closestTier = Object.entries(tierDistribution).reduce((prev, curr) => 
                Math.abs(curr[1] - avgTierValue) < Math.abs(prev[1] - avgTierValue) ? curr : prev
            );
            return closestTier[0];
        }

        function calculateInfluence(avgTier1, avgTier2) {
            let diff = avgTier1 - avgTier2;
            let influenceValue = Math.abs(diff);
            let avgTierValue = (avgTier1 + avgTier2) / 2;
            let avgTierName = getAverageTierName(avgTierValue);
            let influenceTier;

            // 제한된 영향력 범위 계산 (4단계 이내만 표시)
            let maxTierValue = tierDistribution[avgTierName] + 4;
            let minTierValue = tierDistribution[avgTierName] - 4;

            if (avgTier1 > avgTier2) {
                if (avgTier1 <= maxTierValue && avgTier2 >= minTierValue) {
                    influenceTier = getAverageTierName(avgTier1);
                } else {
                    influenceTier = avgTierName;
                }
                return `(1팀이 ${influenceTier} ${(influenceValue / tierDistribution[influenceTier]).toFixed(3)}명만큼 우세함)`;
            } else if (avgTier2 > avgTier1) {
                if (avgTier2 <= maxTierValue && avgTier1 >= minTierValue) {
                    influenceTier = getAverageTierName(avgTier2);
                } else {
                    influenceTier = avgTierName;
                }
                return `(2팀이 ${influenceTier} ${(influenceValue / tierDistribution[influenceTier]).toFixed(3)}명만큼 우세함)`;
            } else {
                return ``;
            }
        }

        function calculateBalancedTeams() {
            let players = [];

            for (let i = 1; i <= 10; i++) {
                let name = document.getElementById('player_name' + i).value;
                let tierName = document.getElementById('player_tier' + i).value;
                if (name.trim() !== "" && tierName.trim() !== "") {
                    let tier = tierDistribution[tierName];
                    players.push({ name: name, tier: tier, tierName: tierName });
                }
            }

            if (players.length !== 10) {
                document.getElementById('result').innerText = '모든 플레이어의 정보를 올바르게 입력해 주세요.';
                return;
            }

            let bestTeam1 = [];
            let bestTeam2 = [];
            let minDiff = Infinity;

            function combinations(arr, k) {
                let result = [];
                function combRecursive(start, chosen) {
                    if (chosen.length === k) {
                        result.push(chosen.slice());
                        return;
                    }
                    for (let i = start; i < arr.length; i++) {
                        chosen.push(arr[i]);
                        combRecursive(i + 1, chosen);
                        chosen.pop();
                    }
                }
                combRecursive(0, []);
                return result;
            }

            let teamCombinations = combinations(players, 5);
            for (let team1 of teamCombinations) {
                let team2 = players.filter(player => !team1.includes(player));

                let avgTier1 = team1.reduce((sum, player) => sum + player.tier, 0) / 5;
                let avgTier2 = team2.reduce((sum, player) => sum + player.tier, 0) / 5;
                let diff = Math.abs(avgTier1 - avgTier2);

                if (diff < minDiff) {
                    minDiff = diff;
                    bestTeam1 = [...team1];
                    bestTeam2 = [...team2];
                }
            }

            bestTeam1.sort((a, b) => b.tier - a.tier);
            bestTeam2.sort((a, b) => b.tier - a.tier);

            let avgTier1Name = getAverageTierName(bestTeam1.reduce((sum, p) => sum + p.tier, 0) / 5);
            let avgTier2Name = getAverageTierName(bestTeam2.reduce((sum, p) => sum + p.tier, 0) / 5);

            let influenceText = calculateInfluence(bestTeam1.reduce((sum, p) => sum + p.tier, 0) / 5, bestTeam2.reduce((sum, p) => sum + p.tier, 0) / 5);

            let resultText = `1팀 : ${bestTeam1.map(p => p.name).join(', ')} (평균 티어: ${avgTier1Name}) ${bestTeam1.map(p => p.tierName).join(', ')}\n`;
            resultText += `2팀 : ${bestTeam2.map(p => p.name).join(', ')} (평균 티어: ${avgTier2Name}) ${bestTeam2.map(p => p.tierName).join(', ')}\n`;
            resultText += `팀 평균 차이: ${minDiff.toFixed(2)}\n${influenceText}`;

            document.getElementById('result').innerText = resultText;
        }

        window.onload = populateTierOptions;
    </script>
</body>
</html>
